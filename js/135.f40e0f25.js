"use strict";(self["webpackChunkresep_bunda"]=self["webpackChunkresep_bunda"]||[]).push([[135],{2249:(e,n,a)=>{a.r(n),a.d(n,{default:()=>b});var t=a(124),u=(a(9753),a(9227));function l(e){if(Array.isArray(e))return(0,u.Z)(e)}a(2526),a(1817),a(1539),a(2165),a(8783),a(3948),a(1038);function r(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var i=a(2780);a(1703),a(6647);function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e){return l(e)||r(e)||(0,i.Z)(e)||o()}var s=a(3144),f=a(8534),d=(a(7042),a(7327),a(6699),a(2023),a(1249),a(7658),a(2564),a(3112),a(3710),a(9714),a(2222),a(6252)),m=a(2262),v=a(3577),p=a(86),w=a(316),S=a(6100),k=a(5856),U=a(4105),_=(0,d._)("h2",null,"Daftar Pengajuan Izin",-1);const g={__name:"LaporanIzin",setup:function(e){var n=(0,w.v0)(k.H),a=(0,S.ad)(k.H),u=(0,m.iH)([]),l=(0,m.iH)({isOpen:!1,message:"",duration:2e3,color:"success"}),r=(0,m.iH)(!1),i=(0,m.iH)(""),o=(0,m.iH)(""),g=(0,m.iH)(""),h=(0,m.iH)(""),b=(0,m.iH)(10),W=(0,m.iH)(null),z=(0,m.iH)(!1),D=(0,m.iH)(""),y=[{value:0,label:"January"},{value:1,label:"February"},{value:2,label:"March"},{value:3,label:"April"},{value:4,label:"May"},{value:5,label:"June"},{value:6,label:"July"},{value:7,label:"August"},{value:8,label:"September"},{value:9,label:"October"},{value:10,label:"November"},{value:11,label:"December"}],I=(0,d.Fl)((function(){return u.value.filter((function(e){var n=e.fullName.toLowerCase().includes(h.value.toLowerCase()),a=e.startDate?e.startDate.toDate().getMonth():null,t=""===D.value||a===D.value;return n&&t})).slice(0,b.value)})),j=function(){var e=(0,f.Z)((0,t.Z)().mark((function e(){var n,l,r,i,o,f=arguments;return(0,t.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=f.length>0&&void 0!==f[0]&&f[0],l=n?(0,S.IO)((0,S.hJ)(a,"izin"),(0,S.ar)("fullName",">=",h.value),(0,S.ar)("fullName","<=",h.value+""),(0,S.b9)(b.value)):(0,S.IO)((0,S.hJ)(a,"izin"),(0,S.ar)("fullName",">=",h.value),(0,S.ar)("fullName","<=",h.value+""),(0,S.TQ)(W.value),(0,S.b9)(b.value)),e.prev=2,e.next=5,(0,S.PL)(l);case 5:r=e.sent,i=r.docs.map((function(e){return(0,s.Z)((0,s.Z)({id:e.id},e.data()),{},{startDate:e.data().startDate,endDate:e.data().endDate})})),n?u.value=i:(o=u.value).push.apply(o,c(i)),W.value=r.docs[r.docs.length-1],z.value=r.docs.length===b.value,console.log("Data izin berhasil diambil:",u.value),e.next=17;break;case 13:e.prev=13,e.t0=e["catch"](2),console.error("Error fetching izin data:",e.t0),A("Terjadi kesalahan saat mengambil data izin","danger");case 17:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(){return e.apply(this,arguments)}}(),x=function(){j(!0)},C=function(){j()},H=function(e,n){o.value=e,g.value=n,r.value=!0},N=function(){r.value=!1,i.value="",o.value="",g.value=""},Y=function(){var e=(0,f.Z)((0,t.Z)().mark((function e(){return(0,t.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,S.r7)((0,S.JU)(a,"izin",o.value),{status:g.value,keteranganStatus:i.value});case 3:A("Status pengajuan izin berhasil diubah menjadi ".concat(g.value),"success"),j(!0),N(),e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](0),console.error("Error updating izin status:",e.t0),A("Terjadi kesalahan saat mengubah status izin","danger");case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),Z=function(e){setTimeout((function(){j(!0),e.target.complete()}),2e3)},A=function(e,n){l.value={isOpen:!0,message:e,duration:2e3,color:n}},G=function(e){if(!e)return"N/A";var n=e.toDate(),a=n.getDate().toString().padStart(2,"0"),t=(n.getMonth()+1).toString().padStart(2,"0"),u=n.getFullYear();return"".concat(a,"/").concat(t,"/").concat(u)},P=function(){var e=I.value.filter((function(e){return"sakit"===e.izinStatus||"izin"===e.izinStatus}));if(0!==e.length){var n=e.map((function(e){return{fullName:e.fullName,role:e.role,izinStatus:e.izinStatus,durasi:e.durasi,keterangan:e.keterangan,fromDate:G(e.startDate),toDate:G(e.endDate),status:e.status,keteranganStatus:e.keteranganStatus}})),a=U.P6.json_to_sheet(n),t=U.P6.book_new();U.P6.book_append_sheet(t,a,"Laporan Izin dan Sakit"),U.NC(t,"laporan_izin_dan_sakit.xlsx"),A("Laporan izin dan sakit berhasil diekspor","success")}else A("Tidak ada data izin atau sakit untuk bulan yang dipilih","warning")};return(0,d.bv)((function(){(0,w.Aj)(n,(function(e){e?j(!0):(console.error("User not authenticated"),A("Pengguna tidak terautentikasi","danger"))}))})),function(e,n){return(0,d.wg)(),(0,d.j4)((0,m.SU)(p._i),null,{default:(0,d.w5)((function(){return[(0,d.Wm)((0,m.SU)(p.Gu),{mode:"ios"},{default:(0,d.w5)((function(){return[(0,d.Wm)((0,m.SU)(p.sr),null,{default:(0,d.w5)((function(){return[(0,d.Wm)((0,m.SU)(p.wd),null,{default:(0,d.w5)((function(){return[(0,d.Uk)("Informasi Pengajuan Izin")]})),_:1}),(0,d.Wm)((0,m.SU)(p.oU),{slot:"start","default-href":"/"})]})),_:1})]})),_:1}),(0,d.Wm)((0,m.SU)(p.W2),{fullscreen:!0},{default:(0,d.w5)((function(){return[(0,d.Wm)((0,m.SU)(p.nJ),{slot:"fixed",onIonRefresh:n[0]||(n[0]=function(e){return Z(e)})},{default:(0,d.w5)((function(){return[(0,d.Wm)((0,m.SU)(p.Wo))]})),_:1}),(0,d.Wm)((0,m.SU)(p.W2),{class:"ion-padding"},{default:(0,d.w5)((function(){return[(0,d.Wm)((0,m.SU)(p.Ie),null,{default:(0,d.w5)((function(){return[(0,d.Wm)((0,m.SU)(p.Q$),null,{default:(0,d.w5)((function(){return[(0,d.Uk)("Search by Name")]})),_:1}),(0,d.Wm)((0,m.SU)(p.pK),{modelValue:h.value,"onUpdate:modelValue":n[1]||(n[1]=function(e){return h.value=e}),placeholder:"Enter name to search"},null,8,["modelValue"])]})),_:1}),(0,d.Wm)((0,m.SU)(p.Ie),null,{default:(0,d.w5)((function(){return[(0,d.Wm)((0,m.SU)(p.Q$),null,{default:(0,d.w5)((function(){return[(0,d.Uk)("Bulan")]})),_:1}),(0,d.Wm)((0,m.SU)(p.t9),{modelValue:D.value,"onUpdate:modelValue":n[2]||(n[2]=function(e){return D.value=e}),placeholder:"Pilih Bulan"},{default:(0,d.w5)((function(){return[((0,d.wg)(),(0,d.iD)(d.HY,null,(0,d.Ko)(y,(function(e){return(0,d.Wm)((0,m.SU)(p.n0),{key:e.value,value:e.value},{default:(0,d.w5)((function(){return[(0,d.Uk)((0,v.zw)(e.label),1)]})),_:2},1032,["value"])})),64))]})),_:1},8,["modelValue"])]})),_:1}),(0,d.Wm)((0,m.SU)(p.YG),{style:{color:"white"},expand:"block",onClick:x},{default:(0,d.w5)((function(){return[(0,d.Uk)("Search")]})),_:1}),(0,d.Wm)((0,m.SU)(p.jY),null,{default:(0,d.w5)((function(){return[(0,d.Wm)((0,m.SU)(p.Nd),null,{default:(0,d.w5)((function(){return[(0,d.Wm)((0,m.SU)(p.wI),null,{default:(0,d.w5)((function(){return[_,(0,d.Wm)((0,m.SU)(p.q_),null,{default:(0,d.w5)((function(){return[((0,d.wg)(!0),(0,d.iD)(d.HY,null,(0,d.Ko)(I.value,(function(e){return(0,d.wg)(),(0,d.j4)((0,m.SU)(p.Ie),{key:e.id},{default:(0,d.w5)((function(){return[(0,d.Wm)((0,m.SU)(p.Q$),null,{default:(0,d.w5)((function(){return[(0,d._)("h3",null,(0,v.zw)(e.fullName)+" - "+(0,v.zw)(e.role),1),(0,d._)("p",null,"Status: "+(0,v.zw)(e.izinStatus),1),(0,d._)("p",null,"Durasi: "+(0,v.zw)(e.durasi)+" hari",1),(0,d._)("p",null,"Keterangan: "+(0,v.zw)(e.keterangan),1),(0,d._)("p",null,"Dari: "+(0,v.zw)(G(e.startDate)),1),(0,d._)("p",null,"Sampai: "+(0,v.zw)(G(e.endDate)),1),(0,d._)("p",null,"Status Admin: "+(0,v.zw)(e.status),1),(0,d._)("p",null,"Keterangan Admin: "+(0,v.zw)(e.keteranganStatus),1)]})),_:2},1024),(0,d.Wm)((0,m.SU)(p.YG),{color:"success",onClick:function(n){return H(e.id,"disetujui")}},{default:(0,d.w5)((function(){return[(0,d.Uk)("Setujui")]})),_:2},1032,["onClick"]),(0,d.Wm)((0,m.SU)(p.YG),{color:"danger",onClick:function(n){return H(e.id,"ditolak")}},{default:(0,d.w5)((function(){return[(0,d.Uk)("Tolak")]})),_:2},1032,["onClick"])]})),_:2},1024)})),128))]})),_:1}),z.value?((0,d.wg)(),(0,d.j4)((0,m.SU)(p.YG),{key:0,expand:"block",onClick:C},{default:(0,d.w5)((function(){return[(0,d.Uk)("Load More")]})),_:1})):(0,d.kq)("",!0)]})),_:1})]})),_:1})]})),_:1}),(0,d.Wm)((0,m.SU)(p.YG),{style:{color:"white"},expand:"block",onClick:P},{default:(0,d.w5)((function(){return[(0,d.Uk)("Export Laporan Sakit")]})),_:1})]})),_:1}),(0,d.Wm)((0,m.SU)(p.Px),{"is-open":l.value.isOpen,message:l.value.message,duration:l.value.duration,color:l.value.color,onDidDismiss:n[3]||(n[3]=function(){return l.value.isOpen=!1})},null,8,["is-open","message","duration","color"]),(0,d.Wm)((0,m.SU)(p.ki),{"is-open":r.value,onDidDismiss:N},{default:(0,d.w5)((function(){return[(0,d.Wm)((0,m.SU)(p.Gu),null,{default:(0,d.w5)((function(){return[(0,d.Wm)((0,m.SU)(p.sr),null,{default:(0,d.w5)((function(){return[(0,d.Wm)((0,m.SU)(p.wd),null,{default:(0,d.w5)((function(){return[(0,d.Uk)("Ubah Status Izin")]})),_:1}),(0,d.Wm)((0,m.SU)(p.Sm),{slot:"end"},{default:(0,d.w5)((function(){return[(0,d.Wm)((0,m.SU)(p.YG),{onClick:N},{default:(0,d.w5)((function(){return[(0,d.Uk)("Close")]})),_:1})]})),_:1})]})),_:1})]})),_:1}),(0,d.Wm)((0,m.SU)(p.W2),null,{default:(0,d.w5)((function(){return[(0,d.Wm)((0,m.SU)(p.Ie),null,{default:(0,d.w5)((function(){return[(0,d.Wm)((0,m.SU)(p.Q$),null,{default:(0,d.w5)((function(){return[(0,d.Uk)("Keterangan")]})),_:1}),(0,d.Wm)((0,m.SU)(p.g2),{modelValue:i.value,"onUpdate:modelValue":n[4]||(n[4]=function(e){return i.value=e}),placeholder:"Masukkan keterangan"},null,8,["modelValue"])]})),_:1}),(0,d.Wm)((0,m.SU)(p.YG),{expand:"block",onClick:Y},{default:(0,d.w5)((function(){return[(0,d.Uk)("Simpan")]})),_:1})]})),_:1})]})),_:1},8,["is-open"])]})),_:1})]})),_:1})}}},h=g,b=h}}]);
//# sourceMappingURL=135.f40e0f25.js.map