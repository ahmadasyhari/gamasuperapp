{"version":3,"file":"js/4369.167caef2.js","mappings":"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","sources":["webpack://resep-bunda/./src/views/user/LaporanIzin.vue","webpack://resep-bunda/./src/views/user/LaporanIzin.vue?55e7"],"sourcesContent":["<template>\r\n  <ion-page>\r\n    <ion-header mode=\"ios\">\r\n      <ion-toolbar>\r\n        <ion-title>Pengajuan Izin</ion-title>\r\n        <ion-back-button slot=\"start\" default-href=\"/\" />\r\n      </ion-toolbar>\r\n    </ion-header>\r\n    <ion-content :fullscreen=\"true\">\r\n      <ion-refresher slot=\"fixed\" @ionRefresh=\"doRefresh($event)\">\r\n        <ion-refresher-content />\r\n      </ion-refresher>\r\n      <ion-content class=\"ion-padding\">\r\n        <ion-item>\r\n          <ion-label>Nama Lengkap</ion-label>\r\n          <ion-input v-model=\"fullName\" readonly style=\"color: red\"></ion-input>\r\n        </ion-item>\r\n        <ion-item>\r\n          <ion-label>Role</ion-label>\r\n          <ion-input v-model=\"role\" readonly style=\"color: red\"></ion-input>\r\n        </ion-item>\r\n        <ion-item>\r\n          <ion-label>Status Izin</ion-label>\r\n          <ion-select v-model=\"izinStatus\" placeholder=\"Pilih Status\">\r\n            <ion-select-option value=\"izin\">Izin</ion-select-option>\r\n            <ion-select-option value=\"sakit\">Sakit</ion-select-option>\r\n          </ion-select>\r\n        </ion-item>\r\n        <ion-item>\r\n          <ion-label>Durasi Izin (hari)</ion-label>\r\n          <ion-input\r\n            v-model=\"durasi\"\r\n            type=\"number\"\r\n            placeholder=\"Masukkan durasi izin\"\r\n          ></ion-input>\r\n        </ion-item>\r\n        <ion-item>\r\n          <ion-label>Dari Tanggal</ion-label>\r\n          <ion-button\r\n            style=\"color: white\"\r\n            expand=\"block\"\r\n            @click=\"openStartDatePicker\"\r\n          >\r\n            {{ startDate ? formatDate(startDate) : \"Pilih Tanggal\" }}\r\n          </ion-button>\r\n        </ion-item>\r\n        <ion-item>\r\n          <ion-label>Sampai Tanggal</ion-label>\r\n          <ion-button\r\n            style=\"color: white\"\r\n            expand=\"block\"\r\n            @click=\"openEndDatePicker\"\r\n          >\r\n            {{ endDate ? formatDate(endDate) : \"Pilih Tanggal\" }}\r\n          </ion-button>\r\n        </ion-item>\r\n        <ion-item>\r\n          <ion-label>Keterangan</ion-label>\r\n          <ion-textarea\r\n            v-model=\"keterangan\"\r\n            placeholder=\"Masukkan keterangan\"\r\n          ></ion-textarea>\r\n        </ion-item>\r\n        <ion-button style=\"color: white\" expand=\"block\" @click=\"ajukanIzin\"\r\n          >Ajukan Izin</ion-button\r\n        >\r\n        <ion-grid>\r\n          <ion-row>\r\n            <ion-col>\r\n              <h2>Daftar Izin</h2>\r\n              <ion-list>\r\n                <ion-item v-for=\"izin in daftarIzin\" :key=\"izin.id\">\r\n                  <ion-label>\r\n                    <h3 style=\"color: red\">\r\n                      {{ izin.fullName }} - {{ izin.role }}\r\n                    </h3>\r\n                    <p style=\"color: red\">Status: {{ izin.izinStatus }}</p>\r\n                    <p style=\"color: red\">Durasi: {{ izin.durasi }} hari</p>\r\n                    <p style=\"color: red\">Keterangan: {{ izin.keterangan }}</p>\r\n                    <p style=\"color: red\">Status Admin: {{ izin.status }}</p>\r\n                    <p style=\"color: red\">\r\n                      Dari: {{ formatDate(izin.startDate) }}\r\n                    </p>\r\n                    <p style=\"color: red\">\r\n                      Sampai: {{ formatDate(izin.endDate) }}\r\n                    </p>\r\n                    <p style=\"color: red\">\r\n                      Tanggal: {{ formatDate(izin.createdAt) }}\r\n                    </p>\r\n                  </ion-label>\r\n                  <ion-button color=\"danger\" @click=\"batalkanIzin(izin.id)\"\r\n                    >Batalkan Izin</ion-button\r\n                  >\r\n                </ion-item>\r\n              </ion-list>\r\n            </ion-col>\r\n          </ion-row>\r\n        </ion-grid>\r\n      </ion-content>\r\n\r\n      <ion-modal\r\n        :is-open=\"isStartDatePickerOpen\"\r\n        @ion-modal-did-dismiss=\"closeStartDatePicker\"\r\n      >\r\n        <ion-content>\r\n          <ion-datetime\r\n            display-format=\"DD/MM/YYYY\"\r\n            picker-format=\"DD/MM/YYYY\"\r\n            v-model=\"startDate\"\r\n            @ionChange=\"closeStartDatePicker\"\r\n          ></ion-datetime>\r\n          <ion-button expand=\"block\" @click=\"closeStartDatePicker\"\r\n            >Tutup</ion-button\r\n          >\r\n        </ion-content>\r\n      </ion-modal>\r\n\r\n      <ion-modal\r\n        :is-open=\"isEndDatePickerOpen\"\r\n        @ion-modal-did-dismiss=\"closeEndDatePicker\"\r\n      >\r\n        <ion-content>\r\n          <ion-datetime\r\n            display-format=\"DD/MM/YYYY\"\r\n            picker-format=\"DD/MM/YYYY\"\r\n            v-model=\"endDate\"\r\n            @ionChange=\"closeEndDatePicker\"\r\n          ></ion-datetime>\r\n          <ion-button expand=\"block\" @click=\"closeEndDatePicker\"\r\n            >Tutup</ion-button\r\n          >\r\n        </ion-content>\r\n      </ion-modal>\r\n\r\n      <ion-toast\r\n        :is-open=\"toast.isOpen\"\r\n        :message=\"toast.message\"\r\n        :duration=\"toast.duration\"\r\n        :color=\"toast.color\"\r\n        @did-dismiss=\"() => (toast.isOpen = false)\"\r\n      ></ion-toast>\r\n    </ion-content>\r\n  </ion-page>\r\n</template>\r\n\r\n<script setup>\r\nimport {\r\n  IonPage,\r\n  IonHeader,\r\n  IonToolbar,\r\n  IonTitle,\r\n  IonBackButton,\r\n  IonContent,\r\n  IonRefresher,\r\n  IonRefresherContent,\r\n  IonItem,\r\n  IonLabel,\r\n  IonSelect,\r\n  IonSelectOption,\r\n  IonInput,\r\n  IonTextarea,\r\n  IonButton,\r\n  IonList,\r\n  IonToast,\r\n  IonCol,\r\n  IonRow,\r\n  IonGrid,\r\n  IonModal,\r\n  IonDatetime,\r\n} from \"@ionic/vue\";\r\nimport { ref, onMounted } from \"vue\";\r\nimport { getAuth, onAuthStateChanged } from \"firebase/auth\";\r\nimport {\r\n  getFirestore,\r\n  doc,\r\n  setDoc,\r\n  serverTimestamp,\r\n  getDoc,\r\n  collection,\r\n  query,\r\n  where,\r\n  getDocs,\r\n  deleteDoc,\r\n} from \"firebase/firestore\";\r\nimport { firebaseApp } from \"../firebase.js\";\r\n\r\nconst auth = getAuth(firebaseApp);\r\nconst db = getFirestore(firebaseApp);\r\n\r\nconst fullName = ref(\"\");\r\nconst role = ref(\"\");\r\nconst izinStatus = ref(\"\");\r\nconst durasi = ref(\"\");\r\nconst keterangan = ref(\"\");\r\nconst startDate = ref(\"\");\r\nconst endDate = ref(\"\");\r\nconst daftarIzin = ref([]);\r\nconst toast = ref({\r\n  isOpen: false,\r\n  message: \"\",\r\n  duration: 2000,\r\n  color: \"success\",\r\n});\r\nconst isStartDatePickerOpen = ref(false);\r\nconst isEndDatePickerOpen = ref(false);\r\n\r\nconst openStartDatePicker = () => {\r\n  isStartDatePickerOpen.value = true;\r\n};\r\n\r\nconst closeStartDatePicker = () => {\r\n  isStartDatePickerOpen.value = false;\r\n};\r\n\r\nconst openEndDatePicker = () => {\r\n  isEndDatePickerOpen.value = true;\r\n};\r\n\r\nconst closeEndDatePicker = () => {\r\n  isEndDatePickerOpen.value = false;\r\n};\r\n\r\nconst fetchUserData = async (uid) => {\r\n  try {\r\n    const userDoc = await getDoc(doc(db, \"users\", uid));\r\n    if (userDoc.exists()) {\r\n      const userData = userDoc.data();\r\n      fullName.value = userData.fullName;\r\n      role.value = userData.role;\r\n    } else {\r\n      console.error(\"User data not found\");\r\n      showToast(\"Data pengguna tidak ditemukan\", \"danger\");\r\n    }\r\n  } catch (error) {\r\n    console.error(\"Error fetching user data:\", error);\r\n    showToast(\"Terjadi kesalahan saat mengambil data pengguna\", \"danger\");\r\n  }\r\n};\r\n\r\nconst fetchIzinData = async (uid) => {\r\n  const q = query(collection(db, \"izin\"), where(\"uid\", \"==\", uid));\r\n  try {\r\n    const querySnapshot = await getDocs(q);\r\n    daftarIzin.value = querySnapshot.docs.map((doc) => ({\r\n      id: doc.id,\r\n      ...doc.data(),\r\n    }));\r\n    console.log(\"Data izin berhasil diambil:\", daftarIzin.value);\r\n  } catch (error) {\r\n    console.error(\"Error fetching izin data:\", error);\r\n    showToast(\"Terjadi kesalahan saat mengambil data izin\", \"danger\");\r\n  }\r\n};\r\n\r\nconst ajukanIzin = async () => {\r\n  const user = auth.currentUser;\r\n  if (user) {\r\n    const izinData = {\r\n      uid: user.uid,\r\n      fullName: fullName.value,\r\n      role: role.value,\r\n      izinStatus: izinStatus.value,\r\n      durasi: durasi.value,\r\n      keterangan: keterangan.value,\r\n      startDate: startDate.value ? new Date(startDate.value) : null,\r\n      endDate: endDate.value ? new Date(endDate.value) : null,\r\n      createdAt: serverTimestamp(),\r\n      status: \"pending\", // Default status pending, admin will approve or reject later\r\n    };\r\n    try {\r\n      await setDoc(\r\n        doc(db, \"izin\", user.uid + \"_\" + new Date().getTime()),\r\n        izinData\r\n      );\r\n      showToast(\"Pengajuan izin berhasil diajukan\", \"success\");\r\n      izinStatus.value = \"\";\r\n      durasi.value = \"\";\r\n      keterangan.value = \"\";\r\n      startDate.value = \"\";\r\n      endDate.value = \"\";\r\n      fetchIzinData(user.uid); // Fetch updated izin data\r\n    } catch (error) {\r\n      console.error(\"Error submitting izin:\", error);\r\n      showToast(\"Terjadi kesalahan saat mengajukan izin\", \"danger\");\r\n    }\r\n  } else {\r\n    console.error(\"User not authenticated\");\r\n    showToast(\"Pengguna tidak terautentikasi\", \"danger\");\r\n  }\r\n};\r\n\r\nconst batalkanIzin = async (izinId) => {\r\n  try {\r\n    await deleteDoc(doc(db, \"izin\", izinId));\r\n    showToast(\"Izin berhasil dibatalkan\", \"success\");\r\n    const user = auth.currentUser;\r\n    if (user) {\r\n      fetchIzinData(user.uid); // Refresh the izin data after deletion\r\n    }\r\n  } catch (error) {\r\n    console.error(\"Error deleting izin:\", error);\r\n    showToast(\"Terjadi kesalahan saat membatalkan izin\", \"danger\");\r\n  }\r\n};\r\n\r\nconst doRefresh = (event) => {\r\n  setTimeout(() => {\r\n    const user = auth.currentUser;\r\n    if (user) {\r\n      fetchIzinData(user.uid);\r\n    }\r\n    event.target.complete();\r\n  }, 2000);\r\n};\r\n\r\nconst showToast = (message, color) => {\r\n  toast.value = {\r\n    isOpen: true,\r\n    message: message,\r\n    duration: 2000,\r\n    color: color,\r\n  };\r\n};\r\n\r\nconst formatDate = (timestamp) => {\r\n  const date = timestamp\r\n    ? timestamp.toDate\r\n      ? timestamp.toDate()\r\n      : new Date(timestamp)\r\n    : null;\r\n  return date ? date.toLocaleDateString(\"id-ID\") : \"N/A\";\r\n};\r\n\r\nonMounted(() => {\r\n  onAuthStateChanged(auth, (user) => {\r\n    if (user) {\r\n      fetchUserData(user.uid);\r\n      fetchIzinData(user.uid);\r\n    } else {\r\n      console.error(\"User not authenticated\");\r\n      showToast(\"Pengguna tidak terautentikasi\", \"danger\");\r\n    }\r\n  });\r\n});\r\n</script>\r\n\r\n<style>\r\n/* Custom styling if needed */\r\n</style>\r\n","import script from \"./LaporanIzin.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./LaporanIzin.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./LaporanIzin.vue?vue&type=style&index=0&id=5c519bc6&lang=css\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["auth","getAuth","firebaseApp","db","getFirestore","fullName","ref","role","izinStatus","durasi","keterangan","startDate","endDate","daftarIzin","toast","isOpen","message","duration","color","isStartDatePickerOpen","isEndDatePickerOpen","openStartDatePicker","value","closeStartDatePicker","openEndDatePicker","closeEndDatePicker","fetchUserData","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","uid","userDoc","userData","wrap","_context","prev","next","getDoc","doc","sent","exists","data","console","error","showToast","t0","stop","_x","apply","arguments","fetchIzinData","_ref2","_callee2","q","querySnapshot","_context2","query","collection","where","getDocs","docs","map","_objectSpread","id","log","_x2","ajukanIzin","_ref3","_callee3","user","izinData","_context3","currentUser","Date","createdAt","serverTimestamp","status","setDoc","getTime","batalkanIzin","_ref4","_callee4","izinId","_context4","deleteDoc","_x3","doRefresh","event","setTimeout","target","complete","formatDate","timestamp","date","toDate","toLocaleDateString","onMounted","onAuthStateChanged","__exports__"],"sourceRoot":""}