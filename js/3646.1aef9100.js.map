{"version":3,"file":"js/3646.1aef9100.js","mappings":"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","sources":["webpack://resep-bunda/./src/views/admin/HalamanPengguna.vue","webpack://resep-bunda/./src/views/admin/HalamanPengguna.vue?6f49"],"sourcesContent":["<template>\r\n  <ion-page>\r\n    <ion-header mode=\"ios\">\r\n      <ion-toolbar>\r\n        <ion-title>Pengguna</ion-title>\r\n        <ion-back-button slot=\"start\" default-href=\"/\" />\r\n      </ion-toolbar>\r\n    </ion-header>\r\n    <ion-content :fullscreen=\"true\">\r\n      <ion-refresher slot=\"fixed\" @ionRefresh=\"doRefresh($event)\">\r\n        <ion-refresher-content />\r\n      </ion-refresher>\r\n      <ion-content class=\"ion-padding\">\r\n        <ion-item>\r\n          <ion-label>Cari Pengguna</ion-label>\r\n          <ion-input\r\n            v-model=\"searchQuery\"\r\n            placeholder=\"Masukkan nama pengguna\"\r\n          ></ion-input>\r\n        </ion-item>\r\n        <ion-button style=\"color: white\" expand=\"block\" @click=\"filterUsers\"\r\n          >Cari</ion-button\r\n        >\r\n        <ion-item>\r\n          <input type=\"file\" accept=\".xlsx, .xls\" @change=\"handleFileUpload\" />\r\n        </ion-item>\r\n\r\n        <ion-button style=\"color: white\" expand=\"block\" @click=\"importFromExcel\">\r\n          Import Pengguna dari Excel\r\n        </ion-button>\r\n\r\n\r\n        <div class=\"table-container\">\r\n          <ion-grid>\r\n            <ion-row>\r\n              <ion-col>\r\n                <h2>Daftar Pengguna</h2>\r\n                <div class=\"table-wrapper\">\r\n                  <table>\r\n                    <thead>\r\n                      <tr>\r\n                        <th>Nama Lengkap</th>\r\n                        <th>Username</th>\r\n                        <th>Email</th>\r\n                        <th>Role</th>\r\n                        <th>QR Code</th>\r\n                        <th>Status</th>\r\n                        <th>Aksi</th>\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      <tr v-for=\"user in filteredUsers\" :key=\"user.id\">\r\n                        <td>{{ user.fullName }}</td>\r\n                        <td>{{ user.username }}</td>\r\n                        <td>{{ user.email }}</td>\r\n                        <td>{{ user.role }}</td>\r\n                        <td>{{ user.qrCode }}</td>\r\n                        <td>{{ user.status }}</td>\r\n                        <td>\r\n                          <ion-button\r\n                            style=\"color: white\"\r\n                            @click=\"editUser(user)\"\r\n                            >Edit</ion-button\r\n                          >\r\n                          <ion-button\r\n                            @click=\"changeStatus(user)\"\r\n                            :color=\"\r\n                              user.status === 'aktif' ? 'danger' : 'success'\r\n                            \"\r\n                          >\r\n                            {{\r\n                              user.status === \"aktif\"\r\n                                ? \"Nonaktifkan\"\r\n                                : \"Aktifkan\"\r\n                            }}\r\n                          </ion-button>\r\n                          <ion-button\r\n                            style=\"color: white\"\r\n                            @click=\"resetPassword(user.email)\"\r\n                            >Reset Password</ion-button\r\n                          >\r\n                          <ion-button\r\n                            color=\"danger\"\r\n                            @click=\"deleteUser(user.id)\"\r\n                            >Hapus</ion-button\r\n                          >\r\n                        </td>\r\n                      </tr>\r\n                    </tbody>\r\n                  </table>\r\n                </div>\r\n              </ion-col>\r\n            </ion-row>\r\n          </ion-grid>\r\n        </div>\r\n        <ion-button style=\"color: white\" expand=\"block\" @click=\"exportToExcel\"\r\n          >Export ke Excel</ion-button\r\n        >\r\n      </ion-content>\r\n      <ion-toast\r\n        :is-open=\"toast.isOpen\"\r\n        :message=\"toast.message\"\r\n        :duration=\"toast.duration\"\r\n        :color=\"toast.color\"\r\n        @did-dismiss=\"() => (toast.isOpen = false)\"\r\n      ></ion-toast>\r\n\r\n      <ion-modal :is-open=\"isModalOpen\" @did-dismiss=\"closeModal\">\r\n        <ion-header>\r\n          <ion-toolbar>\r\n            <ion-title>Edit Pengguna</ion-title>\r\n            <ion-buttons slot=\"end\">\r\n              <ion-button @click=\"closeModal\">Close</ion-button>\r\n            </ion-buttons>\r\n          </ion-toolbar>\r\n        </ion-header>\r\n        <ion-content>\r\n          <ion-item v-if=\"selectedUser\">\r\n            <ion-label>Nama Lengkap</ion-label>\r\n            <ion-input v-model=\"selectedUser.fullName\"></ion-input>\r\n          </ion-item>\r\n          <ion-item v-if=\"selectedUser\">\r\n            <ion-label>Username</ion-label>\r\n            <ion-input v-model=\"selectedUser.username\"></ion-input>\r\n          </ion-item>\r\n          <ion-item v-if=\"selectedUser\">\r\n            <ion-label>Email</ion-label>\r\n            <ion-input v-model=\"selectedUser.email\"></ion-input>\r\n          </ion-item>\r\n          <ion-item v-if=\"selectedUser\">\r\n            <ion-label>Role</ion-label>\r\n            <ion-select v-model=\"selectedUser.role\">\r\n              <ion-select-option value=\"admin\">Admin</ion-select-option>\r\n              <ion-select-option value=\"siswa\">Siswa</ion-select-option>\r\n              <ion-select-option value=\"guru\">Guru</ion-select-option>\r\n            </ion-select>\r\n          </ion-item>\r\n          <ion-item v-if=\"selectedUser\">\r\n            <ion-label>Password Baru</ion-label>\r\n            <ion-input v-model=\"newPassword\" type=\"password\"></ion-input>\r\n          </ion-item>\r\n          <ion-button expand=\"block\" @click=\"saveUser\">Simpan</ion-button>\r\n        </ion-content>\r\n      </ion-modal>\r\n    </ion-content>\r\n  </ion-page>\r\n</template>\r\n\r\n<script setup>\r\nimport {\r\n  IonPage,\r\n  IonHeader,\r\n  IonToolbar,\r\n  IonTitle,\r\n  IonBackButton,\r\n  IonContent,\r\n  IonRefresher,\r\n  IonRefresherContent,\r\n  IonItem,\r\n  IonLabel,\r\n  IonInput,\r\n  IonButton,\r\n  // IonList,\r\n  IonToast,\r\n  IonCol,\r\n  IonRow,\r\n  IonGrid,\r\n  IonModal,\r\n  IonSelect,\r\n  IonSelectOption,\r\n  IonButtons,\r\n} from \"@ionic/vue\";\r\nimport { ref, onMounted, computed } from \"vue\";\r\nimport {\r\n  getAuth,\r\n  onAuthStateChanged,\r\n  sendPasswordResetEmail,\r\n  createUserWithEmailAndPassword,\r\n  updatePassword,\r\n} from \"firebase/auth\";\r\nimport {\r\n  setDoc,\r\n  getFirestore,\r\n  getDocs,\r\n  collection,\r\n  query,\r\n  where,\r\n  updateDoc,\r\n  doc,\r\n  deleteDoc,\r\n} from \"firebase/firestore\";\r\nimport { firebaseApp } from \"../firebase.js\";\r\nimport * as XLSX from \"xlsx\";\r\n\r\nconst auth = getAuth(firebaseApp);\r\nconst db = getFirestore(firebaseApp);\r\n\r\nconst users = ref([]);\r\nconst searchQuery = ref(\"\");\r\nconst toast = ref({\r\n  isOpen: false,\r\n  message: \"\",\r\n  duration: 2000,\r\n  color: \"success\",\r\n});\r\nconst isModalOpen = ref(false);\r\nconst selectedUser = ref({}); // Inisialisasi dengan objek kosong\r\nconst newPassword = ref(\"\"); // Password baru\r\n\r\nconst filteredUsers = computed(() => {\r\n  return users.value.filter((user) =>\r\n    user.fullName.toLowerCase().includes(searchQuery.value.toLowerCase())\r\n  );\r\n});\r\n\r\nconst fetchUsers = async () => {\r\n  const q = query(\r\n    collection(db, \"users\"),\r\n    where(\"fullName\", \">=\", searchQuery.value),\r\n    where(\"fullName\", \"<=\", searchQuery.value + \"\\uf8ff\")\r\n  );\r\n\r\n  try {\r\n    const querySnapshot = await getDocs(q);\r\n    users.value = querySnapshot.docs.map((doc) => ({\r\n      id: doc.id,\r\n      ...doc.data(),\r\n    }));\r\n    console.log(\"Data pengguna berhasil diambil:\", users.value);\r\n  } catch (error) {\r\n    console.error(\"Error fetching user data:\", error);\r\n    showToast(\"Terjadi kesalahan saat mengambil data pengguna\", \"danger\");\r\n  }\r\n};\r\n\r\nconst filterUsers = () => {\r\n  fetchUsers();\r\n};\r\n\r\nconst doRefresh = (event) => {\r\n  setTimeout(() => {\r\n    fetchUsers();\r\n    event.target.complete();\r\n  }, 2000);\r\n};\r\n\r\nconst showToast = (message, color) => {\r\n  toast.value = {\r\n    isOpen: true,\r\n    message: message,\r\n    duration: 2000,\r\n    color: color,\r\n  };\r\n};\r\n\r\nconst exportToExcel = () => {\r\n  const exportData = users.value.map((user) => ({\r\n    fullName: user.fullName,\r\n    username: user.username,\r\n    email: user.email,\r\n    role: user.role,\r\n    qrCode: user.qrCode,\r\n    status: user.status,\r\n  }));\r\n\r\n  const worksheet = XLSX.utils.json_to_sheet(exportData);\r\n  const workbook = XLSX.utils.book_new();\r\n  XLSX.utils.book_append_sheet(workbook, worksheet, \"Pengguna\");\r\n  XLSX.writeFile(workbook, \"daftar_pengguna.xlsx\");\r\n  showToast(\"Data pengguna berhasil diekspor\", \"success\");\r\n};\r\n\r\nconst editUser = (user) => {\r\n  selectedUser.value = { ...user };\r\n  isModalOpen.value = true;\r\n};\r\n\r\nconst saveUser = async () => {\r\n  try {\r\n    const userRef = doc(db, \"users\", selectedUser.value.id);\r\n    await updateDoc(userRef, {\r\n      fullName: selectedUser.value.fullName,\r\n      username: selectedUser.value.username,\r\n      email: selectedUser.value.email,\r\n      role: selectedUser.value.role,\r\n    });\r\n\r\n    if (newPassword.value) {\r\n      const user = await auth.getUser(selectedUser.value.id);\r\n      await updatePassword(user, newPassword.value);\r\n      newPassword.value = \"\";\r\n    }\r\n\r\n    showToast(\"Data pengguna berhasil diperbarui\", \"success\");\r\n    fetchUsers();\r\n    closeModal();\r\n  } catch (error) {\r\n    console.error(\"Error updating user data:\", error);\r\n    showToast(\"Terjadi kesalahan saat memperbarui data pengguna\", \"danger\");\r\n  }\r\n};\r\n\r\nconst resetPassword = async (email) => {\r\n  try {\r\n    await sendPasswordResetEmail(auth, email);\r\n    showToast(\"Email untuk reset password telah dikirim\", \"success\");\r\n  } catch (error) {\r\n    console.error(\"Error sending password reset email:\", error);\r\n    showToast(\"Terjadi kesalahan saat mengirim email reset password\", \"danger\");\r\n  }\r\n};\r\n\r\nconst changeStatus = async (user) => {\r\n  try {\r\n    const newStatus = user.status === \"aktif\" ? \"nonaktif\" : \"aktif\";\r\n    await updateDoc(doc(db, \"users\", user.id), { status: newStatus });\r\n    showToast(\r\n      `Status pengguna berhasil diubah menjadi ${newStatus}`,\r\n      \"success\"\r\n    );\r\n    fetchUsers();\r\n  } catch (error) {\r\n    console.error(\"Error updating user status:\", error);\r\n    showToast(\"Terjadi kesalahan saat mengubah status pengguna\", \"danger\");\r\n  }\r\n};\r\n\r\nconst deleteUser = async (userId) => {\r\n  try {\r\n    await deleteDoc(doc(db, \"users\", userId));\r\n    showToast(\"Pengguna berhasil dihapus\", \"success\");\r\n    fetchUsers();\r\n  } catch (error) {\r\n    console.error(\"Error deleting user:\", error);\r\n    showToast(\"Terjadi kesalahan saat menghapus pengguna\", \"danger\");\r\n  }\r\n};\r\n\r\nconst closeModal = () => {\r\n  isModalOpen.value = false;\r\n  selectedUser.value = {};\r\n  newPassword.value = \"\"; // Reset new password field\r\n};\r\n\r\nconst file = ref(null); // Menyimpan file Excel yang diunggah\r\n// Fungsi menangani file yang diunggah\r\nconst handleFileUpload = (event) => {\r\n  file.value = event.target.files[0];\r\n};\r\n\r\n// Fungsi untuk mengimpor data dari file Excel\r\nconst importFromExcel = async () => {\r\n  if (!file.value) {\r\n    showToast(\"Silakan pilih file Excel terlebih dahulu\", \"danger\");\r\n    return;\r\n  }\r\n\r\n  const reader = new FileReader();\r\n  reader.onload = async (e) => {\r\n    const data = new Uint8Array(e.target.result);\r\n    const workbook = XLSX.read(data, { type: \"array\" });\r\n    const sheetName = workbook.SheetNames[0];\r\n    const worksheet = workbook.Sheets[sheetName];\r\n    const jsonData = XLSX.utils.sheet_to_json(worksheet);\r\n\r\n    for (let user of jsonData) {\r\n      try {\r\n        // Buat akun di Firebase Authentication\r\n        const userCredential = await createUserWithEmailAndPassword(\r\n          auth,\r\n          user.email,\r\n          user.password\r\n        );\r\n\r\n        // Dapatkan user ID dari Firebase Authentication\r\n        const uid = userCredential.user.uid;\r\n\r\n        // Simpan data pengguna di Firestore\r\n        await setDoc(doc(db, \"users\", uid), {\r\n          email: user.email,\r\n          fullName: user.fullName,\r\n          kelas: user.kelas, // Mengambil kelas dari file Excel\r\n          nisn: user.nisn || \"\", // Field opsional\r\n          profilePicture: user.profilePicture, // Mengambil URL gambar dari file Excel\r\n          role: user.role, // Mengambil role dari file Excel\r\n          schoolName: user.schoolName, // Mengambil nama sekolah dari file Excel\r\n          status: user.status, // Mengambil status dari file Excel\r\n          username: user.username,\r\n        });\r\n\r\n        showToast(`Pengguna ${user.fullName} berhasil ditambahkan`, \"success\");\r\n      } catch (error) {\r\n        console.error(\"Error adding user:\", error);\r\n        showToast(`Gagal menambahkan pengguna: ${error.message}`, \"danger\");\r\n      }\r\n    }\r\n\r\n    fetchUsers(); // Memperbarui daftar pengguna\r\n  };\r\n\r\n  reader.readAsArrayBuffer(file.value);\r\n};\r\n\r\n\r\n\r\nonMounted(() => {\r\n  onAuthStateChanged(auth, (user) => {\r\n    if (user) {\r\n      fetchUsers();\r\n    } else {\r\n      console.error(\"User not authenticated\");\r\n      showToast(\"Pengguna tidak terautentikasi\", \"danger\");\r\n    }\r\n  });\r\n});\r\n</script>\r\n\r\n<style>\r\n/* Custom styling if needed */\r\n.table-container {\r\n  overflow-x: auto;\r\n}\r\n.table-wrapper {\r\n  overflow-x: auto;\r\n}\r\ntable {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n}\r\n\r\nth,\r\ntd {\r\n  border: 1px solid #ddd;\r\n  padding: 8px;\r\n}\r\n\r\nth {\r\n  background-color: #f2f2f2;\r\n  text-align: left;\r\n}\r\n\r\ntbody tr:nth-child(even) {\r\n  background-color: #f9f9f9;\r\n}\r\n\r\ntbody tr:hover {\r\n  background-color: #f1f1f1;\r\n}\r\n</style>\r\n","import script from \"./HalamanPengguna.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./HalamanPengguna.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./HalamanPengguna.vue?vue&type=style&index=0&id=24ffb090&lang=css\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["auth","getAuth","firebaseApp","db","getFirestore","users","ref","searchQuery","toast","isOpen","message","duration","color","isModalOpen","selectedUser","newPassword","filteredUsers","computed","value","filter","user","fullName","toLowerCase","includes","fetchUsers","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","q","querySnapshot","wrap","_context","prev","next","query","collection","where","getDocs","sent","docs","map","doc","_objectSpread","id","data","console","log","t0","error","showToast","stop","apply","arguments","filterUsers","doRefresh","event","setTimeout","target","complete","exportToExcel","exportData","username","email","role","qrCode","status","worksheet","XLSX","json_to_sheet","workbook","book_new","book_append_sheet","editUser","saveUser","_ref2","_callee2","userRef","_context2","updateDoc","getUser","updatePassword","closeModal","resetPassword","_ref3","_callee3","_context3","sendPasswordResetEmail","_x","changeStatus","_ref4","_callee4","newStatus","_context4","concat","_x2","deleteUser","_ref5","_callee5","userId","_context5","deleteDoc","_x3","file","handleFileUpload","files","importFromExcel","_ref6","_callee7","reader","_context7","abrupt","FileReader","onload","_ref7","_callee6","e","sheetName","jsonData","_iterator","_step","userCredential","uid","_context6","Uint8Array","result","type","SheetNames","Sheets","sheet_to_json","_createForOfIteratorHelper","s","n","done","createUserWithEmailAndPassword","password","setDoc","kelas","nisn","profilePicture","schoolName","t1","f","finish","_x4","readAsArrayBuffer","onMounted","onAuthStateChanged","__exports__"],"sourceRoot":""}