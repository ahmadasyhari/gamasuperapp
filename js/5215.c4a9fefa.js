"use strict";(self["webpackChunkresep_bunda"]=self["webpackChunkresep_bunda"]||[]).push([[5215],{5215:(e,n,a)=>{a.r(n),a.d(n,{default:()=>h});var r=a(124),t=a(6347),u=a(8534),l=(a(9575),a(1539),a(2472),a(8675),a(2990),a(8927),a(3105),a(5035),a(4345),a(7174),a(3408),a(2958),a(2846),a(4731),a(7209),a(6319),a(8867),a(7789),a(3739),a(9368),a(4483),a(2056),a(3462),a(678),a(7462),a(3824),a(5021),a(2974),a(1439),a(7585),a(5016),a(5315),a(7042),a(2222),a(6252)),s=a(2262),i=a(7208),c=a(4105),o=a(316),f=a(6100),p=a(5856),d={class:"ion-padding"},m=(0,l._)("h2",null,"Import Data Pengguna dari Excel",-1);const v={__name:"HalamanSetting",setup:function(e){var n=(0,o.v0)(p.H),a=(0,f.ad)(p.H),v=(0,s.iH)(null),g=(0,s.iH)(0),h=(0,s.iH)({isOpen:!1,message:"",duration:2e3,color:"success"}),k=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";h.value={isOpen:!0,message:e,duration:2e3,color:n}},w=function(e){v.value=e.target.files[0]},x=function(){var e=(0,u.Z)((0,r.Z)().mark((function e(){var l;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(v.value){e.next=3;break}return k("Silakan pilih file Excel terlebih dahulu","danger"),e.abrupt("return");case 3:l=new FileReader,l.onload=function(){var e=(0,u.Z)((0,r.Z)().mark((function e(u){var l,s,i,p,d,m,v,h,w,x,b,_,U,S,y;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:l=new Uint8Array(u.target.result),s=c.ij(l,{type:"array"}),i=s.SheetNames[0],p=s.Sheets[i],d=c.P6.sheet_to_json(p),m=500,v=0;case 7:if(!(v<d.length)){e.next=48;break}h=(0,f.qs)(a),w=d.slice(v,v+m),x=(0,t.Z)(w),e.prev=11,x.s();case 13:if((b=x.n()).done){e.next=33;break}if(_=b.value,_.email&&_.password&&_.fullName&&_.role){e.next=18;break}return console.error("Data pengguna tidak valid:",_),e.abrupt("continue",31);case 18:return e.prev=18,e.next=21,(0,o.Xb)(n,_.email,_.password);case 21:U=e.sent,S=U.user.uid,y=(0,f.JU)(a,"users",S),h.set(y,{email:_.email,fullName:_.fullName,kelas:_.kelas||"",nisn:_.nisn||"",profilePicture:_.profilePicture||"",role:_.role,schoolName:_.schoolName||"",status:_.status||"aktif",username:_.username||""}),e.next=31;break;case 27:e.prev=27,e.t0=e["catch"](18),console.error("Error creating user:",e.t0),k("Gagal membuat pengguna: ".concat(_.email," - ").concat(e.t0.message),"danger");case 31:e.next=13;break;case 33:e.next=38;break;case 35:e.prev=35,e.t1=e["catch"](11),x.e(e.t1);case 38:return e.prev=38,x.f(),e.finish(38);case 41:return e.next=43,h.commit();case 43:g.value=(v+w.length)/d.length,console.log("Batch ".concat(Math.floor(v/m)+1," selesai"));case 45:v+=m,e.next=7;break;case 48:g.value=1,k("Semua data pengguna berhasil diimpor","success");case 50:case"end":return e.stop()}}),e,null,[[11,35,38,41],[18,27]])})));return function(n){return e.apply(this,arguments)}}(),l.readAsArrayBuffer(v.value);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return function(e,n){return(0,l.wg)(),(0,l.j4)((0,s.SU)(i._i),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,s.SU)(i.Gu),{mode:"ios"},{default:(0,l.w5)((function(){return[(0,l.Wm)((0,s.SU)(i.sr),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,s.SU)(i.wd),null,{default:(0,l.w5)((function(){return[(0,l.Uk)("Import Pengguna")]})),_:1})]})),_:1})]})),_:1}),(0,l.Wm)((0,s.SU)(i.W2),null,{default:(0,l.w5)((function(){return[(0,l._)("div",d,[m,(0,l.Wm)((0,s.SU)(i.Ie),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,s.SU)(i.Q$),null,{default:(0,l.w5)((function(){return[(0,l.Uk)("Upload File Excel")]})),_:1}),(0,l._)("input",{type:"file",accept:".xlsx, .xls",onChange:w},null,32)]})),_:1}),(0,l.Wm)((0,s.SU)(i.YG),{expand:"block",onClick:x},{default:(0,l.w5)((function(){return[(0,l.Uk)(" Import Pengguna ")]})),_:1}),g.value>0&&g.value<1?((0,l.wg)(),(0,l.j4)((0,s.SU)(i.X7),{key:0,value:g.value,type:"determinate",color:"primary"},null,8,["value"])):(0,l.kq)("",!0)]),(0,l.Wm)((0,s.SU)(i.Px),{"is-open":h.value.isOpen,message:h.value.message,duration:h.value.duration,color:h.value.color,onDidDismiss:n[0]||(n[0]=function(){return h.value.isOpen=!1})},null,8,["is-open","message","duration","color"])]})),_:1})]})),_:1})}}},g=v,h=g}}]);
//# sourceMappingURL=5215.c4a9fefa.js.map