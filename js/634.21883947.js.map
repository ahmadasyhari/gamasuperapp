{"version":3,"file":"js/634.21883947.js","mappings":"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","sources":["webpack://resep-bunda/./src/views/guru/LihatNilai.vue","webpack://resep-bunda/./src/views/guru/LihatNilai.vue?29ad"],"sourcesContent":["<template>\n  <ion-page>\n    <ion-header mode=\"ios\">\n      <ion-toolbar>\n        <ion-title>Hasil Ujian</ion-title>\n        <ion-back-button slot=\"start\" default-href=\"/\" />\n      </ion-toolbar>\n    </ion-header>\n    <ion-content :fullscreen=\"true\">\n      <ion-refresher slot=\"fixed\" @ionRefresh=\"doRefresh($event)\">\n        <ion-refresher-content />\n      </ion-refresher>\n      <ion-content class=\"ion-padding\">\n        <ion-item>\n          <ion-label>Filter Kelas</ion-label>\n          <ion-select v-model=\"selectedClass\" @ionChange=\"filterResults\">\n            <ion-select-option value=\"\">Semua Kelas</ion-select-option>\n            <ion-select-option\n              v-for=\"kelas in classes\"\n              :key=\"kelas.id\"\n              :value=\"kelas.name\"\n            >\n              {{ kelas.name }}\n            </ion-select-option>\n          </ion-select>\n        </ion-item>\n        <ion-item>\n          <ion-label>Filter Mata Pelajaran</ion-label>\n          <ion-select v-model=\"selectedSubject\" @ionChange=\"filterResults\">\n            <ion-select-option value=\"\">Semua Mata Pelajaran</ion-select-option>\n            <ion-select-option\n              v-for=\"subject in subjects\"\n              :key=\"subject.id\"\n              :value=\"subject.name\"\n            >\n              {{ subject.name }}\n            </ion-select-option>\n          </ion-select>\n        </ion-item>\n        <ion-button style=\"color: white\" expand=\"block\" @click=\"exportToExcel\">\n          Ekspor ke Excel\n        </ion-button>\n        <ion-grid>\n          <ion-row>\n            <ion-col>\n              <h2>Daftar Hasil Ujian</h2>\n              <ion-list>\n                <ion-item>\n                  <ion-label>\n                    <table>\n                      <thead>\n                        <tr>\n                          <th>Nama Siswa</th>\n                          <th>Kelas</th>\n                          <th>Mata Pelajaran</th>\n                          <th>Nilai</th>\n                          <th>Tanggal</th>\n                        </tr>\n                      </thead>\n                      <tbody>\n                        <tr\n                          v-for=\"result in filteredExamResults\"\n                          :key=\"result.id\"\n                        >\n                          <td>{{ result.userName }}</td>\n                          <td>{{ result.kelasName }}</td>\n                          <td>{{ result.mataPelajaranName }}</td>\n                          <td>\n                            <ion-badge\n                              :color=\"result.score < 65 ? 'danger' : 'success'\"\n                            >\n                              {{ result.score }}\n                            </ion-badge>\n                          </td>\n                          <td>{{ formatDate(result.createdAt) }}</td>\n                        </tr>\n                      </tbody>\n                    </table>\n                  </ion-label>\n                </ion-item>\n              </ion-list>\n            </ion-col>\n          </ion-row>\n        </ion-grid>\n      </ion-content>\n      <ion-toast\n        :is-open=\"toast.isOpen\"\n        :message=\"toast.message\"\n        :duration=\"toast.duration\"\n        :color=\"toast.color\"\n        @did-dismiss=\"() => (toast.isOpen = false)\"\n      ></ion-toast>\n    </ion-content>\n  </ion-page>\n</template>\n\n<script setup>\nimport {\n  IonPage,\n  IonHeader,\n  IonToolbar,\n  IonTitle,\n  IonBackButton,\n  IonContent,\n  IonRefresher,\n  IonRefresherContent,\n  IonGrid,\n  IonRow,\n  IonCol,\n  IonList,\n  IonItem,\n  IonLabel,\n  IonToast,\n  IonBadge,\n  IonSelect,\n  IonSelectOption,\n  IonButton,\n} from \"@ionic/vue\";\nimport { ref, onMounted, computed } from \"vue\";\nimport { getFirestore, collection, getDocs } from \"firebase/firestore\";\nimport { firebaseApp } from \"../firebase.js\";\nimport * as XLSX from \"xlsx\";\n\nconst db = getFirestore(firebaseApp);\nconst examResults = ref([]);\nconst classes = ref([]);\nconst subjects = ref([]);\nconst selectedClass = ref(\"\");\nconst selectedSubject = ref(\"\");\nconst toast = ref({\n  isOpen: false,\n  message: \"\",\n  duration: 2000,\n  color: \"success\",\n});\n\nconst fetchAllExamResults = async () => {\n  try {\n    const resultsSnapshot = await getDocs(collection(db, \"nilaiUjian\"));\n    const results = resultsSnapshot.docs.map((doc) => ({\n      id: doc.id,\n      ...doc.data(),\n    }));\n\n    examResults.value = results;\n    console.log(\"Hasil ujian:\", examResults.value); // Debugging log\n  } catch (error) {\n    console.error(\"Error fetching exam results:\", error);\n    showToast(\"Terjadi kesalahan saat mengambil data hasil ujian.\", \"danger\");\n  }\n};\n\nconst fetchClasses = async () => {\n  const querySnapshot = await getDocs(collection(db, \"kelas\"));\n  classes.value = querySnapshot.docs.map((doc) => ({\n    id: doc.id,\n    ...doc.data(),\n  }));\n};\n\nconst fetchSubjects = async () => {\n  const querySnapshot = await getDocs(collection(db, \"mataPelajaran\"));\n  subjects.value = querySnapshot.docs.map((doc) => ({\n    id: doc.id,\n    ...doc.data(),\n  }));\n};\n\nconst filteredExamResults = computed(() => {\n  return examResults.value.filter((result) => {\n    const classMatch =\n      !selectedClass.value || result.kelasName === selectedClass.value;\n    const subjectMatch =\n      !selectedSubject.value ||\n      result.mataPelajaranName === selectedSubject.value;\n    return classMatch && subjectMatch;\n  });\n});\n\nconst filterResults = () => {\n  console.log(\"Filter applied\");\n};\n\nconst formatDate = (timestamp) => {\n  if (!timestamp) return \"N/A\";\n  const date = new Date(timestamp.seconds * 1000);\n  return date.toLocaleDateString(\"id-ID\", {\n    year: \"numeric\",\n    month: \"short\",\n    day: \"numeric\",\n  });\n};\n\nconst exportToExcel = () => {\n  const worksheet = XLSX.utils.json_to_sheet(filteredExamResults.value);\n  const workbook = XLSX.utils.book_new();\n  XLSX.utils.book_append_sheet(workbook, worksheet, \"Hasil Ujian\");\n  XLSX.writeFile(workbook, \"hasil_ujian.xlsx\");\n};\n\nconst showToast = (message, color) => {\n  toast.value = {\n    isOpen: true,\n    message: message,\n    duration: 2000,\n    color: color,\n  };\n};\n\nconst doRefresh = (event) => {\n  setTimeout(() => {\n    fetchAllExamResults();\n    event.target.complete();\n  }, 2000);\n};\n\nonMounted(() => {\n  fetchAllExamResults();\n  fetchClasses();\n  fetchSubjects();\n});\n</script>\n\n<style scoped>\ntable {\n  width: 100%;\n  border-collapse: collapse;\n  margin-top: 20px;\n}\n\nth,\ntd {\n  border: 1px solid #ddd;\n  padding: 8px;\n  text-align: left;\n}\n\nth {\n  background-color: #f2f2f2;\n  font-weight: bold;\n}\n\ntbody tr:nth-child(even) {\n  background-color: #f9f9f9;\n}\n\ntbody tr:hover {\n  background-color: #f1f1f1;\n}\n</style>\n","import script from \"./LihatNilai.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./LihatNilai.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./LihatNilai.vue?vue&type=style&index=0&id=14a76bec&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-14a76bec\"]])\n\nexport default __exports__"],"names":["db","getFirestore","firebaseApp","examResults","ref","classes","subjects","selectedClass","selectedSubject","toast","isOpen","message","duration","color","fetchAllExamResults","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","resultsSnapshot","results","wrap","_context","prev","next","getDocs","collection","sent","docs","map","doc","_objectSpread","id","data","value","console","log","t0","error","showToast","stop","apply","arguments","fetchClasses","_ref2","_callee2","querySnapshot","_context2","fetchSubjects","_ref3","_callee3","_context3","filteredExamResults","computed","filter","result","classMatch","kelasName","subjectMatch","mataPelajaranName","filterResults","formatDate","timestamp","date","Date","seconds","toLocaleDateString","year","month","day","exportToExcel","worksheet","XLSX","json_to_sheet","workbook","book_new","book_append_sheet","doRefresh","event","setTimeout","target","complete","onMounted","__exports__"],"sourceRoot":""}