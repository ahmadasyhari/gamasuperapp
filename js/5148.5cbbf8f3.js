"use strict";(self["webpackChunkresep_bunda"]=self["webpackChunkresep_bunda"]||[]).push([[5148],{6091:(e,n,r)=>{var a=r(6530).PROPER,t=r(7293),u=r(1361),l="​᠎";e.exports=function(e){return t((function(){return!!u[e]()||l[e]()!==l||a&&u[e].name!==e}))}},3210:(e,n,r)=>{var a=r(2109),t=r(3111).trim,u=r(6091);a({target:"String",proto:!0,forced:u("trim")},{trim:function(){return t(this)}})},5148:(e,n,r)=>{r.r(n),r.d(n,{default:()=>b});var a=r(3144),t=r(124),u=r(8534),l=(r(1249),r(3210),r(8309),r(6252)),o=r(2262),i=r(3577),c=r(7208),s=r(6100),d=r(316),f=r(6708),p=r(6693),m=r(5856),v=function(e){return(0,l.dD)("data-v-0f034451"),e=e(),(0,l.Cn)(),e},g={class:"profile-picture-container"},U=["src"],k=v((function(){return(0,l._)("label",{for:"file-upload",class:"upload-button"},"Ganti Foto Profil",-1)}));const w={__name:"HalamanSetting",setup:function(e){var n=r(6706),v=(0,s.ad)(m.H),w=(0,f.cF)(m.H),h=(0,o.iH)(""),S=(0,o.iH)(""),b=(0,o.iH)(""),W=(0,o.iH)(""),_=(0,o.iH)(""),x=(0,o.iH)(""),V=(0,o.iH)(n),H=(0,o.iH)([]),Q=(0,o.iH)(""),R=(0,o.iH)(""),Z=(0,o.iH)(!1),P=(0,o.iH)({isOpen:!1,message:"",duration:2e3,color:"success"}),K=function(){var e=(0,u.Z)((0,t.Z)().mark((function e(){var r,a,u,l;return(0,t.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=(0,d.v0)(m.H),a=r.currentUser,a){e.next=5;break}return $("Pengguna tidak terautentikasi","danger"),e.abrupt("return");case 5:return e.prev=5,e.next=8,(0,s.QT)((0,s.JU)(v,"users",a.uid));case 8:u=e.sent,u.exists()?(l=u.data(),h.value=l.fullName||"",S.value=l.email||"",b.value=l.username||"",W.value=l.kelas||"",_.value=l.role||"",V.value=l.profilePicture||n,x.value=l.qrCode||"",Q.value=l.nisn||"",R.value=l.schoolName||"",Z.value=!!l.kelas):$("Data pengguna tidak ditemukan","danger"),e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](5),console.error("Error fetching user data:",e.t0),$("Terjadi kesalahan saat mengambil data pengguna","danger");case 16:case"end":return e.stop()}}),e,null,[[5,12]])})));return function(){return e.apply(this,arguments)}}(),y=function(){var e=(0,u.Z)((0,t.Z)().mark((function e(){var n;return(0,t.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,s.PL)((0,s.hJ)(v,"kelas"));case 2:n=e.sent,H.value=n.docs.map((function(e){return(0,a.Z)({id:e.id},e.data())}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),C=function(){var e=(0,u.Z)((0,t.Z)().mark((function e(){var n;return(0,t.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.mR.checkPermission({force:!0});case 3:return e.next=5,p.mR.hideBackground();case 5:return e.next=7,p.mR.startScan();case 7:n=e.sent,n.hasContent&&(x.value=n.content,$("QR Code berhasil dipindai","success")),e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](0),console.error("Error scanning QR code:",e.t0),$("Error scanning QR code","danger");case 15:return e.prev=15,p.mR.showBackground(),p.mR.stopScan(),e.finish(15);case 19:case"end":return e.stop()}}),e,null,[[0,11,15,19]])})));return function(){return e.apply(this,arguments)}}(),I=function(){var e=(0,u.Z)((0,t.Z)().mark((function e(){var n,r;return(0,t.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=(0,d.v0)(m.H),r=n.currentUser,r){e.next=5;break}return $("Pengguna tidak terautentikasi","danger"),e.abrupt("return");case 5:if(""!==x.value.trim()){e.next=8;break}return $("Kode QR tidak boleh kosong","danger"),e.abrupt("return");case 8:return e.prev=8,e.next=11,(0,s.r7)((0,s.JU)(v,"users",r.uid),{qrCode:x.value});case 11:$("Kode QR berhasil didaftarkan","success"),e.next=18;break;case 14:e.prev=14,e.t0=e["catch"](8),console.error("Error registering QR code:",e.t0),$("Gagal mendaftarkan kode QR","danger");case 18:case"end":return e.stop()}}),e,null,[[8,14]])})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=(0,u.Z)((0,t.Z)().mark((function e(){var n,r;return(0,t.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=(0,d.v0)(m.H),r=n.currentUser,r){e.next=5;break}return $("Pengguna tidak terautentikasi","danger"),e.abrupt("return");case 5:return e.prev=5,e.next=8,(0,s.r7)((0,s.JU)(v,"users",r.uid),{fullName:h.value,email:S.value,username:b.value,kelas:W.value,profilePicture:V.value,nisn:Q.value,schoolName:R.value});case 8:$("Informasi pengguna berhasil diperbarui","success"),e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](5),console.error("Error updating user info:",e.t0),$("Gagal memperbarui informasi pengguna","danger");case 15:case"end":return e.stop()}}),e,null,[[5,11]])})));return function(){return e.apply(this,arguments)}}(),G=function(){var e=(0,u.Z)((0,t.Z)().mark((function e(n){var r,a,u,l,o;return(0,t.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=n.target.files[0],r){e.next=3;break}return e.abrupt("return");case 3:if(a=(0,d.v0)(m.H),u=a.currentUser,u){e.next=8;break}return $("Pengguna tidak terautentikasi","danger"),e.abrupt("return");case 8:return l=(0,f.iH)(w,"profile_pictures/".concat(u.uid)),e.prev=9,e.next=12,(0,f.KV)(l,r);case 12:return e.next=14,(0,f.Jt)(l);case 14:return o=e.sent,V.value=o,$("Foto profil berhasil diunggah","success"),e.next=19,(0,s.r7)((0,s.JU)(v,"users",u.uid),{profilePicture:o});case 19:e.next=25;break;case 21:e.prev=21,e.t0=e["catch"](9),console.error("Error uploading profile picture:",e.t0),$("Gagal mengunggah foto profil","danger");case 25:case"end":return e.stop()}}),e,null,[[9,21]])})));return function(n){return e.apply(this,arguments)}}(),N=function(e){Z.value&&($("Tidak bisa mengubah kelas. Hubungi admin.","danger"),W.value=e.target.value)},$=function(e,n){P.value={isOpen:!0,message:e,duration:2e3,color:n}},J=function(e){K(),y(),e.target.complete()};return(0,l.bv)((function(){K(),y()})),function(e,r){return(0,l.wg)(),(0,l.j4)((0,o.SU)(c._i),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,o.SU)(c.Gu),{mode:"ios"},{default:(0,l.w5)((function(){return[(0,l.Wm)((0,o.SU)(c.sr),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,o.SU)(c.wd),null,{default:(0,l.w5)((function(){return[(0,l.Uk)("Pengaturan")]})),_:1}),(0,l.Wm)((0,o.SU)(c.oU),{slot:"start","default-href":"/"})]})),_:1})]})),_:1}),(0,l.Wm)((0,o.SU)(c.W2),{fullscreen:!0},{default:(0,l.w5)((function(){return[(0,l.Wm)((0,o.SU)(c.nJ),{slot:"fixed",onIonRefresh:r[0]||(r[0]=function(e){return J(e)})},{default:(0,l.w5)((function(){return[(0,l.Wm)((0,o.SU)(c.Wo))]})),_:1}),(0,l.Wm)((0,o.SU)(c.W2),{class:"ion-padding"},{default:(0,l.w5)((function(){return[(0,l._)("div",g,[(0,l._)("img",{src:V.value||(0,o.SU)(n),alt:"Profile Picture",class:"profile-picture"},null,8,U),k,(0,l._)("input",{id:"file-upload",type:"file",onChange:G,accept:"image/*"},null,32)]),(0,l.Wm)((0,o.SU)(c.Ie),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,o.SU)(c.Q$),{position:"floating"},{default:(0,l.w5)((function(){return[(0,l.Uk)("Nama Lengkap")]})),_:1}),(0,l.Wm)((0,o.SU)(c.pK),{modelValue:h.value,"onUpdate:modelValue":r[1]||(r[1]=function(e){return h.value=e})},null,8,["modelValue"])]})),_:1}),(0,l.Wm)((0,o.SU)(c.Ie),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,o.SU)(c.Q$),{position:"floating"},{default:(0,l.w5)((function(){return[(0,l.Uk)("Email")]})),_:1}),(0,l.Wm)((0,o.SU)(c.pK),{modelValue:S.value,"onUpdate:modelValue":r[2]||(r[2]=function(e){return S.value=e}),type:"email"},null,8,["modelValue"])]})),_:1}),(0,l.Wm)((0,o.SU)(c.Ie),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,o.SU)(c.Q$),{position:"floating"},{default:(0,l.w5)((function(){return[(0,l.Uk)("Username")]})),_:1}),(0,l.Wm)((0,o.SU)(c.pK),{modelValue:b.value,"onUpdate:modelValue":r[3]||(r[3]=function(e){return b.value=e})},null,8,["modelValue"])]})),_:1}),(0,l.Wm)((0,o.SU)(c.Ie),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,o.SU)(c.Q$),{position:"floating"},{default:(0,l.w5)((function(){return[(0,l.Uk)("NISN")]})),_:1}),(0,l.Wm)((0,o.SU)(c.pK),{modelValue:Q.value,"onUpdate:modelValue":r[4]||(r[4]=function(e){return Q.value=e})},null,8,["modelValue"])]})),_:1}),(0,l.Wm)((0,o.SU)(c.Ie),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,o.SU)(c.Q$),{position:"floating"},{default:(0,l.w5)((function(){return[(0,l.Uk)("Nama Sekolah")]})),_:1}),(0,l.Wm)((0,o.SU)(c.pK),{modelValue:R.value,"onUpdate:modelValue":r[5]||(r[5]=function(e){return R.value=e})},null,8,["modelValue"])]})),_:1}),(0,l.Wm)((0,o.SU)(c.Ie),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,o.SU)(c.Q$),{position:"floating"},{default:(0,l.w5)((function(){return[(0,l.Uk)("Kelas")]})),_:1}),(0,l.Wm)((0,o.SU)(c.t9),{modelValue:W.value,"onUpdate:modelValue":r[6]||(r[6]=function(e){return W.value=e}),placeholder:"Pilih Kelas",disabled:Z.value,onIonChange:N},{default:(0,l.w5)((function(){return[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(H.value,(function(e){return(0,l.wg)(),(0,l.j4)((0,o.SU)(c.n0),{key:e.id,value:e.id},{default:(0,l.w5)((function(){return[(0,l.Uk)((0,i.zw)(e.name),1)]})),_:2},1032,["value"])})),128))]})),_:1},8,["modelValue","disabled"])]})),_:1}),(0,l.Wm)((0,o.SU)(c.Ie),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,o.SU)(c.Q$),{position:"floating"},{default:(0,l.w5)((function(){return[(0,l.Uk)("Role")]})),_:1}),(0,l.Wm)((0,o.SU)(c.pK),{modelValue:_.value,"onUpdate:modelValue":r[7]||(r[7]=function(e){return _.value=e}),readonly:""},null,8,["modelValue"])]})),_:1}),(0,l.Wm)((0,o.SU)(c.YG),{style:{color:"white"},onClick:E,expand:"block"},{default:(0,l.w5)((function(){return[(0,l.Uk)("Perbarui Informasi Pengguna")]})),_:1}),(0,l.Wm)((0,o.SU)(c.Ie),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,o.SU)(c.Q$),{position:"floating"},{default:(0,l.w5)((function(){return[(0,l.Uk)("Kode QR")]})),_:1}),(0,l.Wm)((0,o.SU)(c.pK),{modelValue:x.value,"onUpdate:modelValue":r[8]||(r[8]=function(e){return x.value=e}),placeholder:"Hasil scan QR Code",readonly:""},null,8,["modelValue"])]})),_:1}),(0,l.Wm)((0,o.SU)(c.YG),{style:{color:"white"},onClick:C,expand:"block"},{default:(0,l.w5)((function(){return[(0,l.Uk)("Scan QR Code")]})),_:1}),(0,l.Wm)((0,o.SU)(c.YG),{style:{color:"white"},onClick:I,expand:"block"},{default:(0,l.w5)((function(){return[(0,l.Uk)("Daftarkan Kode QR")]})),_:1})]})),_:1}),(0,l.Wm)((0,o.SU)(c.jY),{class:"ion-padding"}),(0,l.Wm)((0,o.SU)(c.Px),{"is-open":P.value.isOpen,message:P.value.message,duration:P.value.duration,color:P.value.color,onDidDismiss:r[9]||(r[9]=function(){return P.value.isOpen=!1})},null,8,["is-open","message","duration","color"])]})),_:1})]})),_:1})}}};var h=r(3744);const S=(0,h.Z)(w,[["__scopeId","data-v-0f034451"]]),b=S},6706:(e,n,r)=>{e.exports=r.p+"img/avatar.40910a76.png"}}]);
//# sourceMappingURL=5148.5cbbf8f3.js.map