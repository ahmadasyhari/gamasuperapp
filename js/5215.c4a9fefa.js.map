{"version":3,"file":"js/5215.c4a9fefa.js","mappings":"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","sources":["webpack://resep-bunda/./src/views/admin/HalamanSetting.vue","webpack://resep-bunda/./src/views/admin/HalamanSetting.vue?d25d"],"sourcesContent":["<template>\r\n  <ion-page>\r\n    <ion-header mode=\"ios\">\r\n      <ion-toolbar>\r\n        <ion-title>Import Pengguna</ion-title>\r\n      </ion-toolbar>\r\n    </ion-header>\r\n    <ion-content>\r\n      <div class=\"ion-padding\">\r\n        <h2>Import Data Pengguna dari Excel</h2>\r\n        <ion-item>\r\n          <ion-label>Upload File Excel</ion-label>\r\n          <input type=\"file\" accept=\".xlsx, .xls\" @change=\"handleFileUpload\" />\r\n        </ion-item>\r\n        <ion-button expand=\"block\" @click=\"importFromExcel\">\r\n          Import Pengguna\r\n        </ion-button>\r\n\r\n        <!-- Progres Bar -->\r\n        <ion-progress-bar\r\n          v-if=\"progress > 0 && progress < 1\"\r\n          :value=\"progress\"\r\n          type=\"determinate\"\r\n          color=\"primary\"\r\n        ></ion-progress-bar>\r\n      </div>\r\n\r\n      <!-- Toast -->\r\n      <ion-toast\r\n        :is-open=\"toast.isOpen\"\r\n        :message=\"toast.message\"\r\n        :duration=\"toast.duration\"\r\n        :color=\"toast.color\"\r\n        @did-dismiss=\"() => (toast.isOpen = false)\"\r\n      ></ion-toast>\r\n    </ion-content>\r\n  </ion-page>\r\n</template>\r\n\r\n<script setup>\r\nimport {\r\n  IonPage,\r\n  IonHeader,\r\n  IonToolbar,\r\n  IonTitle,\r\n  IonContent,\r\n  IonItem,\r\n  IonLabel,\r\n  IonButton,\r\n  IonProgressBar,\r\n  IonToast,\r\n} from \"@ionic/vue\";\r\nimport { ref } from \"vue\";\r\nimport * as XLSX from \"xlsx\";\r\nimport { getAuth, createUserWithEmailAndPassword } from \"firebase/auth\";\r\nimport { getFirestore, doc, writeBatch } from \"firebase/firestore\";\r\nimport { firebaseApp } from \"../firebase\";\r\n\r\nconst auth = getAuth(firebaseApp);\r\nconst db = getFirestore(firebaseApp);\r\n\r\nconst file = ref(null);\r\nconst progress = ref(0);\r\nconst toast = ref({\r\n  isOpen: false,\r\n  message: \"\",\r\n  duration: 2000,\r\n  color: \"success\",\r\n});\r\n\r\nconst showToast = (message, color = \"success\") => {\r\n  toast.value = {\r\n    isOpen: true,\r\n    message: message,\r\n    duration: 2000,\r\n    color: color,\r\n  };\r\n};\r\n\r\nconst handleFileUpload = (event) => {\r\n  file.value = event.target.files[0];\r\n};\r\n\r\nconst importFromExcel = async () => {\r\n  if (!file.value) {\r\n    showToast(\"Silakan pilih file Excel terlebih dahulu\", \"danger\");\r\n    return;\r\n  }\r\n\r\n  const reader = new FileReader();\r\n  reader.onload = async (e) => {\r\n    const data = new Uint8Array(e.target.result);\r\n    const workbook = XLSX.read(data, { type: \"array\" });\r\n    const sheetName = workbook.SheetNames[0];\r\n    const worksheet = workbook.Sheets[sheetName];\r\n    const jsonData = XLSX.utils.sheet_to_json(worksheet);\r\n\r\n    const batchSize = 500;\r\n    for (let i = 0; i < jsonData.length; i += batchSize) {\r\n      const batch = writeBatch(db);\r\n      const chunk = jsonData.slice(i, i + batchSize);\r\n\r\n      for (let user of chunk) {\r\n        if (!user.email || !user.password || !user.fullName || !user.role) {\r\n          console.error(\"Data pengguna tidak valid:\", user);\r\n          continue;\r\n        }\r\n\r\n        try {\r\n          const userCredential = await createUserWithEmailAndPassword(\r\n            auth,\r\n            user.email,\r\n            user.password\r\n          );\r\n          const uid = userCredential.user.uid;\r\n          const userRef = doc(db, \"users\", uid);\r\n          batch.set(userRef, {\r\n            email: user.email,\r\n            fullName: user.fullName,\r\n            kelas: user.kelas || \"\",\r\n            nisn: user.nisn || \"\",\r\n            profilePicture: user.profilePicture || \"\",\r\n            role: user.role,\r\n            schoolName: user.schoolName || \"\",\r\n            status: user.status || \"aktif\",\r\n            username: user.username || \"\",\r\n          });\r\n        } catch (error) {\r\n          console.error(\"Error creating user:\", error);\r\n          showToast(\r\n            `Gagal membuat pengguna: ${user.email} - ${error.message}`,\r\n            \"danger\"\r\n          );\r\n        }\r\n      }\r\n\r\n      await batch.commit();\r\n      progress.value = (i + chunk.length) / jsonData.length;\r\n      console.log(`Batch ${Math.floor(i / batchSize) + 1} selesai`);\r\n    }\r\n\r\n    progress.value = 1;\r\n    showToast(\"Semua data pengguna berhasil diimpor\", \"success\");\r\n  };\r\n\r\n  reader.readAsArrayBuffer(file.value);\r\n};\r\n</script>\r\n","import script from \"./HalamanSetting.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./HalamanSetting.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["auth","getAuth","firebaseApp","db","getFirestore","file","ref","progress","toast","isOpen","message","duration","color","showToast","arguments","length","undefined","value","handleFileUpload","event","target","files","importFromExcel","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee2","reader","wrap","_context2","prev","next","abrupt","FileReader","onload","_ref2","_callee","e","data","workbook","sheetName","worksheet","jsonData","batchSize","i","batch","chunk","_iterator","_step","user","userCredential","uid","userRef","_context","Uint8Array","result","XLSX","type","SheetNames","Sheets","sheet_to_json","writeBatch","slice","_createForOfIteratorHelper","s","n","done","email","password","fullName","role","console","error","createUserWithEmailAndPassword","sent","doc","set","kelas","nisn","profilePicture","schoolName","status","username","t0","concat","t1","f","finish","commit","log","Math","floor","stop","_x","apply","readAsArrayBuffer","__exports__"],"sourceRoot":""}