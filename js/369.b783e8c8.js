"use strict";(self["webpackChunkresep_bunda"]=self["webpackChunkresep_bunda"]||[]).push([[369],{4369:(e,n,a)=>{a.r(n),a.d(n,{default:()=>z});var u=a(3144),t=a(124),r=a(8534),l=(a(1249),a(3710),a(2564),a(6252)),i=a(2262),o=a(3577),c=a(86),d=a(316),s=a(6100),f=a(5856),m=(0,l._)("h2",null,"Daftar Izin",-1),p={style:{color:"red"}},U={style:{color:"red"}},v={style:{color:"red"}},w={style:{color:"red"}},k={style:{color:"red"}},S={style:{color:"red"}},g={style:{color:"red"}},_={style:{color:"red"}};const W={__name:"LaporanIzin",setup:function(e){var n=(0,d.v0)(f.H),a=(0,s.ad)(f.H),W=(0,i.iH)(""),h=(0,i.iH)(""),z=(0,i.iH)(""),D=(0,i.iH)(""),b=(0,i.iH)(""),I=(0,i.iH)(""),x=(0,i.iH)(""),Y=(0,i.iH)([]),y=(0,i.iH)({isOpen:!1,message:"",duration:2e3,color:"success"}),V=(0,i.iH)(!1),H=(0,i.iH)(!1),T=function(){V.value=!0},j=function(){V.value=!1},Z=function(){H.value=!0},M=function(){H.value=!1},C=function(){var e=(0,r.Z)((0,t.Z)().mark((function e(n){var u,r;return(0,t.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,s.QT)((0,s.JU)(a,"users",n));case 3:u=e.sent,u.exists()?(r=u.data(),W.value=r.fullName,h.value=r.role):(console.error("User data not found"),A("Data pengguna tidak ditemukan","danger")),e.next=11;break;case 7:e.prev=7,e.t0=e["catch"](0),console.error("Error fetching user data:",e.t0),A("Terjadi kesalahan saat mengambil data pengguna","danger");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(n){return e.apply(this,arguments)}}(),P=function(){var e=(0,r.Z)((0,t.Z)().mark((function e(n){var r,l;return(0,t.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=(0,s.IO)((0,s.hJ)(a,"izin"),(0,s.ar)("uid","==",n)),e.prev=1,e.next=4,(0,s.PL)(r);case 4:l=e.sent,Y.value=l.docs.map((function(e){return(0,u.Z)({id:e.id},e.data())})),console.log("Data izin berhasil diambil:",Y.value),e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](1),console.error("Error fetching izin data:",e.t0),A("Terjadi kesalahan saat mengambil data izin","danger");case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(n){return e.apply(this,arguments)}}(),Q=function(){var e=(0,r.Z)((0,t.Z)().mark((function e(){var u,r;return(0,t.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(u=n.currentUser,!u){e.next=21;break}return r={uid:u.uid,fullName:W.value,role:h.value,izinStatus:z.value,durasi:D.value,keterangan:b.value,startDate:I.value?new Date(I.value):null,endDate:x.value?new Date(x.value):null,createdAt:(0,s.Bt)(),status:"pending"},e.prev=3,e.next=6,(0,s.pl)((0,s.JU)(a,"izin",u.uid+"_"+(new Date).getTime()),r);case 6:A("Pengajuan izin berhasil diajukan","success"),z.value="",D.value="",b.value="",I.value="",x.value="",P(u.uid),e.next=19;break;case 15:e.prev=15,e.t0=e["catch"](3),console.error("Error submitting izin:",e.t0),A("Terjadi kesalahan saat mengajukan izin","danger");case 19:e.next=23;break;case 21:console.error("User not authenticated"),A("Pengguna tidak terautentikasi","danger");case 23:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(){return e.apply(this,arguments)}}(),$=function(){var e=(0,r.Z)((0,t.Z)().mark((function e(u){var r;return(0,t.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,s.oe)((0,s.JU)(a,"izin",u));case 3:A("Izin berhasil dibatalkan","success"),r=n.currentUser,r&&P(r.uid),e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](0),console.error("Error deleting izin:",e.t0),A("Terjadi kesalahan saat membatalkan izin","danger");case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(n){return e.apply(this,arguments)}}(),G=function(e){setTimeout((function(){var a=n.currentUser;a&&P(a.uid),e.target.complete()}),2e3)},A=function(e,n){y.value={isOpen:!0,message:e,duration:2e3,color:n}},K=function(e){var n=e?e.toDate?e.toDate():new Date(e):null;return n?n.toLocaleDateString("id-ID"):"N/A"};return(0,l.bv)((function(){(0,d.Aj)(n,(function(e){e?(C(e.uid),P(e.uid)):(console.error("User not authenticated"),A("Pengguna tidak terautentikasi","danger"))}))})),function(e,n){return(0,l.wg)(),(0,l.j4)((0,i.SU)(c._i),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(c.Gu),{mode:"ios"},{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(c.sr),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(c.wd),null,{default:(0,l.w5)((function(){return[(0,l.Uk)("Pengajuan Izin")]})),_:1}),(0,l.Wm)((0,i.SU)(c.oU),{slot:"start","default-href":"/"})]})),_:1})]})),_:1}),(0,l.Wm)((0,i.SU)(c.W2),{fullscreen:!0},{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(c.nJ),{slot:"fixed",onIonRefresh:n[0]||(n[0]=function(e){return G(e)})},{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(c.Wo))]})),_:1}),(0,l.Wm)((0,i.SU)(c.W2),{class:"ion-padding"},{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(c.Ie),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(c.Q$),null,{default:(0,l.w5)((function(){return[(0,l.Uk)("Nama Lengkap")]})),_:1}),(0,l.Wm)((0,i.SU)(c.pK),{modelValue:W.value,"onUpdate:modelValue":n[1]||(n[1]=function(e){return W.value=e}),readonly:"",style:{color:"red"}},null,8,["modelValue"])]})),_:1}),(0,l.Wm)((0,i.SU)(c.Ie),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(c.Q$),null,{default:(0,l.w5)((function(){return[(0,l.Uk)("Role")]})),_:1}),(0,l.Wm)((0,i.SU)(c.pK),{modelValue:h.value,"onUpdate:modelValue":n[2]||(n[2]=function(e){return h.value=e}),readonly:"",style:{color:"red"}},null,8,["modelValue"])]})),_:1}),(0,l.Wm)((0,i.SU)(c.Ie),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(c.Q$),null,{default:(0,l.w5)((function(){return[(0,l.Uk)("Status Izin")]})),_:1}),(0,l.Wm)((0,i.SU)(c.t9),{modelValue:z.value,"onUpdate:modelValue":n[3]||(n[3]=function(e){return z.value=e}),placeholder:"Pilih Status"},{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(c.n0),{value:"izin"},{default:(0,l.w5)((function(){return[(0,l.Uk)("Izin")]})),_:1}),(0,l.Wm)((0,i.SU)(c.n0),{value:"sakit"},{default:(0,l.w5)((function(){return[(0,l.Uk)("Sakit")]})),_:1})]})),_:1},8,["modelValue"])]})),_:1}),(0,l.Wm)((0,i.SU)(c.Ie),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(c.Q$),null,{default:(0,l.w5)((function(){return[(0,l.Uk)("Durasi Izin (hari)")]})),_:1}),(0,l.Wm)((0,i.SU)(c.pK),{modelValue:D.value,"onUpdate:modelValue":n[4]||(n[4]=function(e){return D.value=e}),type:"number",placeholder:"Masukkan durasi izin"},null,8,["modelValue"])]})),_:1}),(0,l.Wm)((0,i.SU)(c.Ie),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(c.Q$),null,{default:(0,l.w5)((function(){return[(0,l.Uk)("Dari Tanggal")]})),_:1}),(0,l.Wm)((0,i.SU)(c.YG),{style:{color:"white"},expand:"block",onClick:T},{default:(0,l.w5)((function(){return[(0,l.Uk)((0,o.zw)(I.value?K(I.value):"Pilih Tanggal"),1)]})),_:1})]})),_:1}),(0,l.Wm)((0,i.SU)(c.Ie),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(c.Q$),null,{default:(0,l.w5)((function(){return[(0,l.Uk)("Sampai Tanggal")]})),_:1}),(0,l.Wm)((0,i.SU)(c.YG),{style:{color:"white"},expand:"block",onClick:Z},{default:(0,l.w5)((function(){return[(0,l.Uk)((0,o.zw)(x.value?K(x.value):"Pilih Tanggal"),1)]})),_:1})]})),_:1}),(0,l.Wm)((0,i.SU)(c.Ie),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(c.Q$),null,{default:(0,l.w5)((function(){return[(0,l.Uk)("Keterangan")]})),_:1}),(0,l.Wm)((0,i.SU)(c.g2),{modelValue:b.value,"onUpdate:modelValue":n[5]||(n[5]=function(e){return b.value=e}),placeholder:"Masukkan keterangan"},null,8,["modelValue"])]})),_:1}),(0,l.Wm)((0,i.SU)(c.YG),{style:{color:"white"},expand:"block",onClick:Q},{default:(0,l.w5)((function(){return[(0,l.Uk)("Ajukan Izin")]})),_:1}),(0,l.Wm)((0,i.SU)(c.jY),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(c.Nd),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(c.wI),null,{default:(0,l.w5)((function(){return[m,(0,l.Wm)((0,i.SU)(c.q_),null,{default:(0,l.w5)((function(){return[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(Y.value,(function(e){return(0,l.wg)(),(0,l.j4)((0,i.SU)(c.Ie),{key:e.id},{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(c.Q$),null,{default:(0,l.w5)((function(){return[(0,l._)("h3",p,(0,o.zw)(e.fullName)+" - "+(0,o.zw)(e.role),1),(0,l._)("p",U,"Status: "+(0,o.zw)(e.izinStatus),1),(0,l._)("p",v,"Durasi: "+(0,o.zw)(e.durasi)+" hari",1),(0,l._)("p",w,"Keterangan: "+(0,o.zw)(e.keterangan),1),(0,l._)("p",k,"Status Admin: "+(0,o.zw)(e.status),1),(0,l._)("p",S," Dari: "+(0,o.zw)(K(e.startDate)),1),(0,l._)("p",g," Sampai: "+(0,o.zw)(K(e.endDate)),1),(0,l._)("p",_," Tanggal: "+(0,o.zw)(K(e.createdAt)),1)]})),_:2},1024),(0,l.Wm)((0,i.SU)(c.YG),{color:"danger",onClick:function(n){return $(e.id)}},{default:(0,l.w5)((function(){return[(0,l.Uk)("Batalkan Izin")]})),_:2},1032,["onClick"])]})),_:2},1024)})),128))]})),_:1})]})),_:1})]})),_:1})]})),_:1})]})),_:1}),(0,l.Wm)((0,i.SU)(c.ki),{"is-open":V.value,onIonModalDidDismiss:j},{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(c.W2),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(c.x4),{"display-format":"DD/MM/YYYY","picker-format":"DD/MM/YYYY",modelValue:I.value,"onUpdate:modelValue":n[6]||(n[6]=function(e){return I.value=e}),onIonChange:j},null,8,["modelValue"]),(0,l.Wm)((0,i.SU)(c.YG),{expand:"block",onClick:j},{default:(0,l.w5)((function(){return[(0,l.Uk)("Tutup")]})),_:1})]})),_:1})]})),_:1},8,["is-open"]),(0,l.Wm)((0,i.SU)(c.ki),{"is-open":H.value,onIonModalDidDismiss:M},{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(c.W2),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(c.x4),{"display-format":"DD/MM/YYYY","picker-format":"DD/MM/YYYY",modelValue:x.value,"onUpdate:modelValue":n[7]||(n[7]=function(e){return x.value=e}),onIonChange:M},null,8,["modelValue"]),(0,l.Wm)((0,i.SU)(c.YG),{expand:"block",onClick:M},{default:(0,l.w5)((function(){return[(0,l.Uk)("Tutup")]})),_:1})]})),_:1})]})),_:1},8,["is-open"]),(0,l.Wm)((0,i.SU)(c.Px),{"is-open":y.value.isOpen,message:y.value.message,duration:y.value.duration,color:y.value.color,onDidDismiss:n[8]||(n[8]=function(){return y.value.isOpen=!1})},null,8,["is-open","message","duration","color"])]})),_:1})]})),_:1})}}},h=W,z=h}}]);
//# sourceMappingURL=369.b783e8c8.js.map